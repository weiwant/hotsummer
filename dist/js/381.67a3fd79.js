"use strict";(self["webpackChunkmis"]=self["webpackChunkmis"]||[]).push([[381],{8301:function(e,t,a){a.d(t,{Z:function(){return c}});var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"componentSubsection toolbar"},[a("label",{staticClass:"customFileName"},[e._v("文件名： "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.exportFileName,expression:"exportFileName"}],attrs:{type:"text"},domProps:{value:e.exportFileName},on:{input:function(t){t.target.composing||(e.exportFileName=t.target.value)}}})]),a("span",{staticClass:"defaultExportfileName"},[e._v("（ 默认为："+e._s(e.defaultFileName)+"）")]),a("button",{staticClass:"workloadFileProcessingBtn",class:{disabled:e.disabled},attrs:{disabled:e.disabled},on:{click:function(t){return e.exportFile()}}},[e._v("  "+e._s(e.btnText)+" ")])])},s=[],l={name:"DownloadExcelFile",data(){return{exportFileName:""}},props:["defaultFileName","disabled","btnText"],methods:{exportFile(){let e;e=""==this.exportFileName?this.defaultFileName:this.exportFileName,this.$emit("exportFile",e)}}},n=l,o=a(3736),i=(0,o.Z)(n,r,s,!1,null,"65796c82",null),c=i.exports},6640:function(e,t,a){a.d(t,{Z:function(){return c}});var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"componentSubsection"},[a("ul",{staticClass:"resultStatistics"},[a("li",[a("div",{staticClass:"name"},[e._v("查询结果数")]),a("div",{staticClass:"value"},[e._v(e._s(e.totalItems))])]),a("li",[a("div",{staticClass:"name"},[e._v("总页数")]),a("div",{staticClass:"value"},[e._v(e._s(e.allPageCount))])])])])},s=[],l={name:"TableStatisticsBar",props:["totalItems","allPageCount"]},n=l,o=a(3736),i=(0,o.Z)(n,r,s,!1,null,"02082fdb",null),c=i.exports},5163:function(e,t,a){a.d(t,{Z:function(){return c}});var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tableFilter"},[a("label",[e._v("年份 "),a("select",{directives:[{name:"model",rawName:"v-model",value:e.yearChosen,expression:"yearChosen"}],on:{change:[function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.yearChosen=t.target.multiple?a:a[0]},e.selectYear]}},e._l(5,(function(t){return a("option",{key:t,domProps:{value:e.currentYear-t+1}},[e._v(" "+e._s(e.currentYear-t+1)+" ")])})),0)]),a("button",{staticClass:"universalBlueBtn confirmYearBtn",on:{click:function(t){return e.confirmYear()}}},[e._v(" 确 认 ")])])},s=[],l={name:"YearFilter",data(){return{currentYear:this.$currentYear,yearChosen:this.$currentYear}},methods:{selectYear(){this.$emit("yearSelected",this.yearChosen)},confirmYear(){this.$emit("yearConfirmed",this.yearChosen)}}},n=l,o=a(3736),i=(0,o.Z)(n,r,s,!1,null,"41bb54d7",null),c=i.exports},381:function(e,t,a){a.r(t),a.d(t,{default:function(){return p}});var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"componentWrapper"},[a("div",{staticClass:"componentSectionTitle"},[e._v("教学工作量")]),a("YearFilter",{on:{yearConfirmed:e.yearConfirmed}}),a("TableStatisticsBar",{attrs:{allPageCount:e.allPageCount,totalItems:e.totalItems}}),a("DownloadExcelFile",{attrs:{btnText:"导出excel至本地",disabled:!e.dataExists,defaultFileName:e.yearChosen+"年度工作量"},on:{exportFile:e.exportFile}}),a("div",{staticClass:"workloadTableWrapper"},[e.dataExists?e._e():a("div",{staticClass:"noDataHint",domProps:{textContent:e._s(e.noDataHint)}}),a("table",{staticClass:"workloadDataTable"},[a("thead",[a("tr",e._l(e.workloadTableHeader,(function(t,r){return a("th",{key:r},[e._v(" "+e._s(t)+" ")])})),0)]),a("tbody",e._l(e.workloadTableData,(function(t){return a("tr",{key:t.id,staticClass:"tableDataLine"},e._l(t,(function(t,r){return a("td",{key:r},[e._v(" "+e._s(t)+" ")])})),0)})),0)])])],1)},s=[],l=a(6166),n=a.n(l),o=a(6640),i=a(8301),c=a(5163),u={name:"TeacherWorkloadTable",components:{TableStatisticsBar:o.Z,DownloadExcelFile:i.Z,YearFilter:c.Z},data(){return{currentTeacherName:"",totalItems:0,allPageCount:0,currentPage:0,yearChosen:this.$currentYear,workloadTableHeader:[],workloadTableData:[],dataExists:!1,noDataHint:""}},computed:{noLessPage(){return 0==this.currentPage||1==this.currentPage},noMorePage(){return this.currentPage==this.allPageCount}},methods:{getTableData(){n().post(`${this.$domainName}/resource/customIndeed`,{year:this.yearChosen,teacherName:this.currentTeacherName}).then((e=>{console.log(e),204!=e.data.response.code?(this.dataExists=!0,this.workloadTableHeader=["课程号","课程名称","教学班","开课学院","学分","课程性质","年级","专业","上课老师","职称","上课人数","计算用学时","合课单位","备注","实验安排","其他教师","辅助","课程性质说明","是否卓工或弘毅","是否全英文"],this.workloadTableData=e.data.data):(this.dataExists=!1,this.workloadTableHeader=[],this.workloadTableData=[],this.noDataHint=`暂无${this.currentAcademicYear}学年，第${this.currentSemester}学期的数据！`)}))},yearConfirmed(e){this.yearChosen=e,console.log(this.yearChosen)},exportFile(e){a.e(86).then(a.bind(a,3086)).then((t=>{const a=t.utils.json_to_sheet(this.workloadTableData),r=t.utils.decode_range(a["!ref"]).e.c;for(let e=0;e<=r;e++)a[t.utils.encode_cell({r:0,c:e})].v=this.workloadTableHeader[e];const s=t.utils.book_new();t.utils.book_append_sheet(s,a,"data"),t.writeFile(s,e+".xlsx")}))}},created(){this.currentTeacherName=localStorage.getItem("teacherName"),this.getTableData()}},d=u,m=a(3736),h=(0,m.Z)(d,r,s,!1,null,"b81e5588",null),p=h.exports}}]);
//# sourceMappingURL=381.67a3fd79.js.map