"use strict";(self["webpackChunkmis"]=self["webpackChunkmis"]||[]).push([[975],{1975:function(e,t,a){a.r(t),a.d(t,{default:function(){return _}});var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"componentWrapper"},[a("div",{staticClass:"componentSectionTitle"},[e._v("查看教学工作量")]),a("FilterWithSearch",{attrs:{searchKeywords:e.searchKeywords},on:{yearOnly:e.confirmYear,yearAndSearchValue:e.search}}),a("TableStatisticsBar",{attrs:{allPageCount:e.allPageCount,totalItems:e.totalItems}}),a("DownloadExcelFile",{attrs:{btnText:"导出excel至本地",disabled:!e.dataExists,defaultFileName:e.yearChosen+"年度工作量"},on:{exportFile:e.exportFile}}),a("div",{staticClass:"workloadTableWrapper"},[e.dataExists?e._e():a("div",{staticClass:"noDataHint",domProps:{innerHTML:e._s(e.noDataHint)}}),a("table",{staticClass:"workloadDataTable"},[e.dataExists?a("thead",[a("tr",e._l(e.workloadTableHeader,(function(t,r){return a("th",{key:r},[e._v(" "+e._s(t)+" ")])})),0)]):e._e(),a("tbody",e._l(e.workloadTableData,(function(t){return a("tr",{key:t.id,staticClass:"tableDataLine"},e._l(t,(function(t,r){return a("td",{key:r},[e._v(e._s(t))])})),0)})),0)])]),a("div",{staticClass:"pagination"},[a("button",{attrs:{disabled:e.noLessPage},on:{click:function(t){return e.pageBefore()}}},[e._v("<")]),e._v(" 第 "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.cPage,expression:"cPage"}],attrs:{type:"text"},domProps:{value:e.cPage},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.choosePage()},input:function(t){t.target.composing||(e.cPage=t.target.value)}}}),e._v(" 页 "),a("button",{attrs:{disabled:e.noMorePage},on:{click:function(t){return e.pageAfter()}}},[e._v(">")])])],1)},s=[],n=a(6166),i=a.n(n),o=a(6640),l=a(8301),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tableFilter"},[a("YearFilter",{on:{yearSelected:e.selectYear,yearConfirmed:e.confirmYearOnly}}),a("div",{staticClass:"wrapper"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.searchKeyword,expression:"searchKeyword"}],staticClass:"search",attrs:{id:""},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.searchKeyword=t.target.multiple?a:a[0]}}},e._l(e.searchKeywords,(function(t,r){return a("option",{key:r,domProps:{value:t}},[e._v(" "+e._s(t)+" ")])})),0),a("input",{directives:[{name:"model",rawName:"v-model",value:e.searchValue,expression:"searchValue"}],staticClass:"search",attrs:{type:"search",placeholder:"查询内容"},domProps:{value:e.searchValue},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search()},input:function(t){t.target.composing||(e.searchValue=t.target.value)}}}),a("button",{staticClass:"searchBtn universalBlueBtn",on:{click:function(t){return e.search()}}},[e._v("")])])],1)},u=[],d=a(5163),h={name:"FilterWithSearch",components:{YearFilter:d.Z},props:["searchKeywords"],data(){return{year:"",searchKeyword:this.searchKeywords[0],searchValue:""}},methods:{confirmYearOnly(e){this.year=e,this.$emit("yearOnly",this.year)},selectYear(e){this.year=e},search(){""!=this.searchValue&&this.$emit("yearAndSearchValue",year,this.searchKeyword,this.searchValue.trim())}}},p=h,m=a(3736),g=(0,m.Z)(p,c,u,!1,null,"ea2255a2",null),v=g.exports,b={name:"CheckWorkload",components:{TableStatisticsBar:o.Z,DownloadExcelFile:l.Z,FilterWithSearch:v},data(){return{currentYear:this.$currentYear,yearChosen:this.$currentYear,searchKeywords:["上课老师","教分"],searchKeyword:"",searchValue:"",currentPage:0,allPageCount:0,workloadTableHeader:["学年","辅助","计算用学时","课程性质解释","计算机用时","课程名称","课程性质","课程号","学分","折扣","实验安排","实验课时","教分","合课单位","实验室核对结果","上课教师名字","教师职称","专业","折扣前BA1系数","原始教分","其他教师名","计划学院","实践课时","备注","学期","是否为特殊班级","是否全英教学","上课人数","年级","教学班","BA1系数","开课学院","理论课时"],workloadTableData:[],totalItems:0,dataExists:!1,noDataHint:"",dataTobeExported:[],exportFileName:""}},computed:{noLessPage(){return 0==this.currentPage||1==this.currentPage},noMorePage(){return this.currentPage==this.allPageCount}},methods:{getTableData(){i().post(`${this.$domainName}/resource/tableinsemester`,{year:this.currentAcademicYear,pageNumber:this.currentPage}).then((e=>{console.log(e),204!=e.data.response.code?(this.dataExists=!0,this.workloadTableData=e.data.data.records,this.allPageCount=e.data.data.pages,this.currentPage=1,this.totalItems=e.data.data.total):(this.dataExists=!1,this.allPageCount=0,this.currentPage=0,this.workloadTableData=[],this.noDataHint=`暂无&nbsp;&nbsp;${this.yearChosen}&nbsp;&nbsp;年度的数据！`)}))},confirmYear(e){this.yearChosen=e,this.currentPage=1,this.getTableData()},pageBefore(){1!=this.currentPage&&(this.currentPage=this.currentPage-1,this.noMorePage=!1,1==this.currentPage&&(this.noLessPage=!0),this.getTableData())},pageAfter(){this.currentPage!=this.allPageCount&&(this.currentPage=this.currentPage+1,this.noLessPage=!1,this.currentPage==this.allPageCount&&(this.noMorePage=!0),this.getTableData())},choosePage(){this.currentPage<1||this.currentPage>this.allPageCount||this.getTableData()},search(e,t,a){switch(this.yearChosen=e,this.searchKeyword=t,this.searchValue=a,t){case"上课老师":i().post(`${this.$domainName}/search/searchIndeed`,{year:e,teacherName:a}).then((e=>{200==e.data.response.code?(this.dataExists=!0,this.workloadTableData=e.data.data,this.totalItems=this.workloadTableData.length,this.currentPage=1):(this.dataExists=!1,this.workloadTableData=[],this.currentPage=0,this.noDataHint=`暂无&nbsp;&nbsp;${this.year}&nbsp;&nbsp;年度，${this.searchKeyword}&nbsp;&nbsp;为&nbsp;&nbsp;${this.searchValue}&nbsp;&nbsp;的数据！`)}));break;case"教分":console.log(e),console.log(t),console.log(a)}},exportFile(e){i().post(`${this.$domainName}/resource/tabledownload`,{year:this.currentAcademicYear,semester:this.currentSemester}).then((t=>{this.dataTobeExported=t.data.data,a.e(86).then(a.bind(a,3086)).then((t=>{const a=t.utils.json_to_sheet(this.dataTobeExported),r=t.utils.decode_range(a["!ref"]).e.c;for(let e=0;e<=r;e++)a[t.utils.encode_cell({r:0,c:e})].v=this.workloadTableHeader[e];const s=t.utils.book_new();t.utils.book_append_sheet(s,a,"data"),t.writeFile(s,e+".xlsx")}))})),this.dataTobeExported=[]}},created(){this.getTableData()}},y=b,f=(0,m.Z)(y,r,s,!1,null,"3ace0046",null),_=f.exports},8301:function(e,t,a){a.d(t,{Z:function(){return c}});var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"componentSubsection toolbar"},[a("label",{staticClass:"customFileName"},[e._v("文件名： "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.exportFileName,expression:"exportFileName"}],attrs:{type:"text"},domProps:{value:e.exportFileName},on:{input:function(t){t.target.composing||(e.exportFileName=t.target.value)}}})]),a("span",{staticClass:"defaultExportfileName"},[e._v("（ 默认为："+e._s(e.defaultFileName)+"）")]),a("button",{staticClass:"workloadFileProcessingBtn",class:{disabled:e.disabled},attrs:{disabled:e.disabled},on:{click:function(t){return e.exportFile()}}},[e._v("  "+e._s(e.btnText)+" ")])])},s=[],n={name:"DownloadExcelFile",data(){return{exportFileName:""}},props:["defaultFileName","disabled","btnText"],methods:{exportFile(){let e;e=""==this.exportFileName?this.defaultFileName:this.exportFileName,this.$emit("exportFile",e)}}},i=n,o=a(3736),l=(0,o.Z)(i,r,s,!1,null,"65796c82",null),c=l.exports},6640:function(e,t,a){a.d(t,{Z:function(){return c}});var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"componentSubsection"},[a("ul",{staticClass:"resultStatistics"},[a("li",[a("div",{staticClass:"name"},[e._v("查询结果数")]),a("div",{staticClass:"value"},[e._v(e._s(e.totalItems))])]),a("li",[a("div",{staticClass:"name"},[e._v("总页数")]),a("div",{staticClass:"value"},[e._v(e._s(e.allPageCount))])])])])},s=[],n={name:"TableStatisticsBar",props:["totalItems","allPageCount"]},i=n,o=a(3736),l=(0,o.Z)(i,r,s,!1,null,"02082fdb",null),c=l.exports},5163:function(e,t,a){a.d(t,{Z:function(){return c}});var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tableFilter"},[a("label",[e._v("年份 "),a("select",{directives:[{name:"model",rawName:"v-model",value:e.yearChosen,expression:"yearChosen"}],on:{change:[function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.yearChosen=t.target.multiple?a:a[0]},e.selectYear]}},e._l(5,(function(t){return a("option",{key:t,domProps:{value:e.currentYear-t+1}},[e._v(" "+e._s(e.currentYear-t+1)+" ")])})),0)]),a("button",{staticClass:"universalBlueBtn confirmYearBtn",on:{click:function(t){return e.confirmYear()}}},[e._v(" 确 认 ")])])},s=[],n={name:"YearFilter",data(){return{currentYear:this.$currentYear,yearChosen:this.$currentYear}},methods:{selectYear(){this.$emit("yearSelected",this.yearChosen)},confirmYear(){this.$emit("yearConfirmed",this.yearChosen)}}},i=n,o=a(3736),l=(0,o.Z)(i,r,s,!1,null,"41bb54d7",null),c=l.exports}}]);
//# sourceMappingURL=975.8d1909c7.js.map