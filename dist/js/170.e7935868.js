"use strict";(self["webpackChunkmis"]=self["webpackChunkmis"]||[]).push([[170],{5170:function(e,a,t){t.r(a),t.d(a,{default:function(){return c}});var l=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"componentWrapper"},[t("div",{staticClass:"componentSectionTitle"},[e._v("上传教学工作量")]),1==e.managerType?t("div",{staticClass:"componentSubtitle"},[e._v("课程工作量")]):e._e(),1==e.managerType?t("div",{staticClass:"componentSubsection"},[t("label",[e._v("年份:  "),t("select",{directives:[{name:"model",rawName:"v-model",value:e.yearForClassWorkloadTable,expression:"yearForClassWorkloadTable"}],on:{change:function(a){var t=Array.prototype.filter.call(a.target.options,(function(e){return e.selected})).map((function(e){var a="_value"in e?e._value:e.value;return a}));e.yearForClassWorkloadTable=a.target.multiple?t:t[0]}}},e._l(5,(function(a){return t("option",{key:a},[e._v(" "+e._s(e.currentYear-a+1)+" ")])})),0)]),t("el-input",{ref:"file",attrs:{type:"file",name:"file",multiple:"false",accept:".xls,.xlsx"},on:{change:e.getFileData},model:{value:e.file,callback:function(a){e.file=a},expression:"file"}}),t("button",{staticClass:"workloadFileProcessingBtn",on:{click:function(a){return e.downloadTemplate(1)}}},[e._v("  模版下载 ")])],1):e._e(),3!=e.managerType?t("div",{staticClass:"componentSubtitle"},[e._v("监考工作量")]):e._e(),3!=e.managerType?t("div",{staticClass:"componentSubsection"},[t("label",[e._v("年份:  "),t("select",{directives:[{name:"model",rawName:"v-model",value:e.yearForExaminationWorkloadTable,expression:"yearForExaminationWorkloadTable"}],on:{change:function(a){var t=Array.prototype.filter.call(a.target.options,(function(e){return e.selected})).map((function(e){var a="_value"in e?e._value:e.value;return a}));e.yearForExaminationWorkloadTable=a.target.multiple?t:t[0]}}},e._l(5,(function(a){return t("option",{key:a},[e._v(" "+e._s(e.currentYear-a+1)+" ")])})),0)]),t("el-input",{ref:"file",attrs:{type:"file",name:"file",multiple:"false",accept:".xls,.xlsx"},on:{change:e.getFileData},model:{value:e.file,callback:function(a){e.file=a},expression:"file"}}),t("button",{staticClass:"workloadFileProcessingBtn",on:{click:function(a){return e.downloadTemplate(2)}}},[e._v("  模版下载 ")])],1):e._e(),2!=e.managerType?t("div",{staticClass:"componentSubtitle"},[e._v("**工作量")]):e._e(),2!=e.managerType?t("div",{staticClass:"componentSubsection"},[t("label",[e._v("年份:  "),t("select",{directives:[{name:"model",rawName:"v-model",value:e.yearForXXWorkloadTable,expression:"yearForXXWorkloadTable"}],on:{change:function(a){var t=Array.prototype.filter.call(a.target.options,(function(e){return e.selected})).map((function(e){var a="_value"in e?e._value:e.value;return a}));e.yearForXXWorkloadTable=a.target.multiple?t:t[0]}}},e._l(5,(function(a){return t("option",{key:a},[e._v(" "+e._s(e.currentYear-a+1)+" ")])})),0)]),t("el-input",{ref:"file",attrs:{type:"file",name:"file",multiple:"false",accept:".xls,.xlsx"},on:{change:e.getFileData},model:{value:e.file,callback:function(a){e.file=a},expression:"file"}}),t("button",{staticClass:"workloadFileProcessingBtn",on:{click:function(a){return e.downloadTemplate(3)}}},[e._v("  模版下载 ")])],1):e._e()])},o=[],n={name:"UploadWorkload",data(){return{managerType:1,currentYear:this.$currentYear,yearForClassWorkloadTable:this.$currentYear,yearForExaminationWorkloadTable:this.$currentYear,yearForXXWorkloadTable:this.$currentYear,classWorkloadTableTemplate:[{"年份":"","上课老师":""}],examinationWorkloadTableTemplate:[],xxWorkloadTableTemplate:[]}},methods:{uploadMaterial(){this.$refs.file.dispatchEvent(new MouseEvent("click"))},getFileData(e){const a=this.$refs.file;let t=e;t.substring(t.lastIndexOf(".")+1);this.uploadFile(a.$refs.input.files[0])},uploadFile(e){const a=new FormData;var t=this,l=this.$data.uploadFileYearInfo1,o=l+1;t.year=l+"-"+o,t.semester=this.$data.uploadFileSemesterInfo,a.append("year",t.year),a.append("semester",t.semester),a.append("file",e),axios.post(`${this.$domainName}/file/upload`,a,{headers:{"Content-Type":"multipart/form-datas"}}).then((e=>{200==e.data.response.code?alert("报表文件上传成功！"):alert("上传失败！")})).catch((function(e){console.log(e)}))},downloadTemplate(e){t.e(86).then(t.bind(t,3086)).then((a=>{let t,l;switch(e){case 1:t=a.utils.json_to_sheet(this.classWorkloadTableTemplate),l="课程工作量（模版）";break;case 2:t=a.utils.json_to_sheet(this.examinationWorkloadTableTemplate),l="监考工作量（模版）";break;case 3:t=a.utils.json_to_sheet(this.xxWorkloadTableTemplate),l="XX工作量（模版）";break}const o=a.utils.book_new();a.utils.book_append_sheet(o,t,"data"),a.writeFile(o,l+".xlsx")}))}},created(){}},r=n,i=t(3736),s=(0,i.Z)(r,l,o,!1,null,"31042eb7",null),c=s.exports}}]);
//# sourceMappingURL=170.e7935868.js.map